CREATE USER CARLOSMILENA_T03_P01 IDENTIFIED BY CARLOSMILENA_T03_P01;
GRANT DBA TO CARLOSMILENA_T03_P01;

--DROPEOS-----------------------------------------------------------------------
--DROP TABLE FACT_ART;
--DROP TABLE ARTICULOS;
--DROP TABLE FAMILIAS;
--DROP TABLE FACTURAS;
--DROP TABLE CLIENTES;
COMMIT;
--TABLAS------------------------------------------------------------------------
CREATE TABLE FAMILIAS(
    CodFamilia VARCHAR2(20),--PK
    NomFamilia VARCHAR2(100),
    DescFamilia VARCHAR2(100)
);
CREATE TABLE ARTICULOS(
    CodArticulo VARCHAR2(20),--PK
    CodFamilia VARCHAR2(20),--FK REFERENCIA A FAMILIAS
    NomArticulo VARCHAR2(100),    
    PrecioArticulo NUMBER(12,2) 
);
CREATE TABLE FACT_ART(--TABLA RELACIÓN ARTICULOS-FACTURAS
    NumFactura NUMBER(20),--FK REFERENCIA A FACTURAS, PK COMPUESTA
    CodArticulo VARCHAR2(20)--FK REFERENCIA A ARTICULOS, PK COMPUESTA
);
CREATE TABLE FACTURAS(
    NumFactura NUMBER(20),--PK
    CodCliente VARCHAR2(20),--FK REFERENCIA A CLIENTES
    FechaFactura DATE
);
CREATE TABLE CLIENTES(
    CodCliente VARCHAR2(20),--PK
    NomCliente VARCHAR2(100),
    DomicilioCli VARCHAR2(100)
);
COMMIT;
--PK'S--------------------------------------------------------------------------
ALTER TABLE FAMILIAS ADD CONSTRAINT PK_CODFAM PRIMARY KEY (CodFamilia);
ALTER TABLE ARTICULOS ADD CONSTRAINT PK_CODART PRIMARY KEY (CodArticulo);
ALTER TABLE FACT_ART ADD CONSTRAINT PK_NUFAC_COART PRIMARY KEY (NumFactura, CodArticulo);
ALTER TABLE FACTURAS ADD CONSTRAINT PK_NUMFAC PRIMARY KEY (NumFactura);
ALTER TABLE CLIENTES ADD CONSTRAINT PK_CODCLI PRIMARY KEY (CodCliente);
COMMIT;
--FK'S--------------------------------------------------------------------------
ALTER TABLE ARTICULOS ADD CONSTRAINT FK_FAMILIAS
    FOREIGN KEY (CodFamilia) REFERENCES FAMILIAS(CodFamilia) ON DELETE CASCADE;
ALTER TABLE FACT_ART ADD CONSTRAINT FK_ARTICULOS
    FOREIGN KEY (CodArticulo) REFERENCES ARTICULOS(CodArticulo) ON DELETE CASCADE;
ALTER TABLE FACT_ART ADD CONSTRAINT FK_FACTURAS
    FOREIGN KEY (NumFactura) REFERENCES FACTURAS(NumFactura) ON DELETE CASCADE;
ALTER TABLE FACTURAS ADD CONSTRAINT FK_DNICLI
    FOREIGN KEY (CodCliente) REFERENCES CLIENTES(CodCliente) ON DELETE CASCADE;
COMMIT;
--REGISTROS---------------------------------------------------------------------
--FAMILIAS:
INSERT INTO FAMILIAS VALUES('FAM_001', 'SOMBREROS', 'COMPLEMENTOS TIPO SOMBRERO');
INSERT INTO FAMILIAS VALUES('FAM_002', 'ZAPATOS', 'PRENDA TIPO CALZADO');
INSERT INTO FAMILIAS VALUES('FAM_003', 'PANTALÓN', 'PRENDA TIPO PANTALÓN');
COMMIT;

--ARTICULOS DE LA FAMILIA SOMBREROS (FAM_001):
INSERT INTO ARTICULOS VALUES('ART_001', 'FAM_001', 'SOMBRERO DE COPA',  10.5);
INSERT INTO ARTICULOS VALUES('ART_002', 'FAM_001', 'SOMBRERO BOMBÍN', 15.99);
INSERT INTO ARTICULOS VALUES('ART_003', 'FAM_001', 'SOMBRERO PANAMÁ', 20.39);
INSERT INTO ARTICULOS VALUES('ART_004', 'FAM_001', 'SOMBRERO FEDORA', 30.99);
INSERT INTO ARTICULOS VALUES('ART_005', 'FAM_001', 'SOMBRERO BOINA', 15.49);

--ARTICULOS DE LA FAMILIA CALZADO (FAM_002):
INSERT INTO ARTICULOS VALUES('ART_006', 'FAM_002', 'ZAPATOS DE VESTIR', 50.25);
INSERT INTO ARTICULOS VALUES('ART_007', 'FAM_002', 'BOTAS DE CUERO', 65.99);
INSERT INTO ARTICULOS VALUES('ART_008', 'FAM_002', 'ZAPATILLAS DEPORTIVAS', 42.75);
INSERT INTO ARTICULOS VALUES('ART_009', 'FAM_002', 'MOCASINES DE GAMUZA', 38.49);
INSERT INTO ARTICULOS VALUES('ART_010', 'FAM_002', 'SANDALIAS DE PLAYA', 20.99);

--ARTICULOS DE LA FAMILIA PANTALÓN (FAM_003):
INSERT INTO ARTICULOS VALUES('ART_011', 'FAM_003', 'PANTALÓN VAQUERO', 45.50);
INSERT INTO ARTICULOS VALUES('ART_012', 'FAM_003', 'PANTALÓN CHINO', 33.75);
INSERT INTO ARTICULOS VALUES('ART_013', 'FAM_003', 'PANTALÓN CORTO', 22.99);
INSERT INTO ARTICULOS VALUES('ART_014', 'FAM_003', 'PANTALÓN DE VESTIR', 55.25);
INSERT INTO ARTICULOS VALUES('ART_015', 'FAM_003', 'LEGGINGS DEPORTIVOS', 28.49);
COMMIT;

--CLIENTES:
INSERT INTO CLIENTES VALUES('CLI_001', 'CLIENTEUNO', 'CALLE ALBA');
INSERT INTO CLIENTES VALUES('CLI_002', 'CLIENTEDOS', 'CALLE ATARDECER');
INSERT INTO CLIENTES VALUES('CLI_003', 'CLIENTETRES', 'CALLE NOCHE');
COMMIT;

--FACTURAS DEL CLIENTE CLIENTEUNO (CLI_001):
INSERT INTO FACTURAS VALUES (0, 'CLI_001', TO_DATE('21-10-2021', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (1, 'CLI_001', TO_DATE('22-10-2022', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (2, 'CLI_001', TO_DATE('23-10-2023', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (3, 'CLI_002', TO_DATE('24-10-2021', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (4, 'CLI_002', TO_DATE('25-10-2022', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (5, 'CLI_002', TO_DATE('26-10-2023', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (6, 'CLI_003', TO_DATE('27-10-2021', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (7, 'CLI_003', TO_DATE('28-10-2022', 'DD-MM-YYYY'));
INSERT INTO FACTURAS VALUES (8, 'CLI_003', TO_DATE('29-10-2023', 'DD-MM-YYYY'));
COMMIT;


--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 0:
INSERT INTO FACT_ART VALUES(0, 'ART_001');
INSERT INTO FACT_ART VALUES(0, 'ART_002');
INSERT INTO FACT_ART VALUES(0, 'ART_003');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 1:
INSERT INTO FACT_ART VALUES(1, 'ART_004');
INSERT INTO FACT_ART VALUES(1, 'ART_005');
INSERT INTO FACT_ART VALUES(1, 'ART_006');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 2:
INSERT INTO FACT_ART VALUES(2, 'ART_007');
INSERT INTO FACT_ART VALUES(2, 'ART_008');
INSERT INTO FACT_ART VALUES(2, 'ART_009');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 3:
INSERT INTO FACT_ART VALUES(3, 'ART_010');
INSERT INTO FACT_ART VALUES(3, 'ART_011');
INSERT INTO FACT_ART VALUES(3, 'ART_012');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 4:
INSERT INTO FACT_ART VALUES(4, 'ART_013');
INSERT INTO FACT_ART VALUES(4, 'ART_014');
INSERT INTO FACT_ART VALUES(4, 'ART_015');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 5:
INSERT INTO FACT_ART VALUES(5, 'ART_001');
INSERT INTO FACT_ART VALUES(5, 'ART_002');
INSERT INTO FACT_ART VALUES(5, 'ART_003');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 6:
INSERT INTO FACT_ART VALUES(6, 'ART_004');
INSERT INTO FACT_ART VALUES(6, 'ART_005');
INSERT INTO FACT_ART VALUES(6, 'ART_006');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 7:
INSERT INTO FACT_ART VALUES(7, 'ART_007');
INSERT INTO FACT_ART VALUES(7, 'ART_008');
INSERT INTO FACT_ART VALUES(7, 'ART_009');
--FACT_ART (LINEAS DE FACTURA) DE LA FACTURA 8:
INSERT INTO FACT_ART VALUES(8, 'ART_010');
INSERT INTO FACT_ART VALUES(8, 'ART_011');
INSERT INTO FACT_ART VALUES(8, 'ART_012');
COMMIT;
